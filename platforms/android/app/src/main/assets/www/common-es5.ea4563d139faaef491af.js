function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function asyncGeneratorStep(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){asyncGeneratorStep(a,r,i,o,s,"next",e)}function s(e){asyncGeneratorStep(a,r,i,o,s,"throw",e)}o(void 0)}))}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"0/6H":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("A36C"),i=n("iWo5"),a=n("qULd"),o=function(e,t){var n,o,s=function(e,r,i){if("undefined"!=typeof document){var a=document.elementFromPoint(e,r);a&&t(a)?a!==n&&(u(),c(a,i)):u()}},c=function(e,t){n=e,o||(o=n);var i=n;Object(r.f)((function(){return i.classList.add("ion-activated")})),t()},u=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n){var t=n;Object(r.f)((function(){return t.classList.remove("ion-activated")})),e&&o!==n&&n.click(),n=void 0}};return Object(i.createGesture)({el:e,gestureName:"buttonActiveDrag",threshold:0,onStart:function(e){return s(e.currentX,e.currentY,a.a)},onMove:function(e){return s(e.currentX,e.currentY,a.b)},onEnd:function(){u(!0),Object(a.e)(),o=void 0}})}},"74mu":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s}));var r=function(e,t){return null!==t.closest(e)},i=function(e,t){return"string"==typeof e&&e.length>0?Object.assign(_defineProperty({"ion-color":!0},"ion-color-"+e,!0),t):t},a=function(e){var t={};return function(e){return void 0!==e?(Array.isArray(e)?e:e.split(" ")).filter((function(e){return null!=e})).map((function(e){return e.trim()})).filter((function(e){return""!==e})):[]}(e).forEach((function(e){return t[e]=!0})),t},o=/^[a-z][a-z0-9+\-.]*:/,s=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,i){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t||"#"===t[0]||o.test(t)){e.next=4;break}if(!(a=document.querySelector("ion-router"))){e.next=4;break}return e.abrupt("return",(null!=n&&n.preventDefault(),a.push(t,r,i)));case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},EahQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("8Y7J"),i=function(){var e=function(){function e(){_classCallCheck(this,e),this.key="readAds"}return _createClass(e,[{key:"saveItem",value:function(e){var t=localStorage.getItem(this.key);(t=t?JSON.parse(t):[]).push(e);var n=Array.from(new Set(t));localStorage.setItem(this.key,JSON.stringify(n))}},{key:"getItem",value:function(e){var t=localStorage.getItem(this.key);return 0!=(t=t?JSON.parse(t):[]).length&&-1!==t.indexOf(e)}}]),e}();return e.ngInjectableDef=r.Qb({factory:function(){return new e},token:e,providedIn:"root"}),e}()},ZaV5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return",t.attachViewToDom(n,r,a,i));case 2:if("string"==typeof r||r instanceof HTMLElement){e.next=4;break}throw new Error("framework delegate is missing");case 4:if(o="string"==typeof r?n.ownerDocument&&n.ownerDocument.createElement(r):r,i&&i.forEach((function(e){return o.classList.add(e)})),a&&Object.assign(o,a),n.appendChild(o),e.t0=o.componentOnReady,!e.t0){e.next=12;break}return e.next=12,o.componentOnReady();case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})));return function(t,n,r,i,a){return e.apply(this,arguments)}}(),i=function(e,t){if(t){if(e)return e.removeViewFromDom(t.parentElement,t);t.remove()}return Promise.resolve()}},h3R7:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={bubbles:{dur:1e3,circles:9,fn:function(e,t,n){var r=e*t/n-e+"ms",i=2*Math.PI*t/n;return{r:5,style:{top:9*Math.sin(i)+"px",left:9*Math.cos(i)+"px","animation-delay":r}}}},circles:{dur:1e3,circles:8,fn:function(e,t,n){var r=t/n,i=e*r-e+"ms",a=2*Math.PI*r;return{r:5,style:{top:9*Math.sin(a)+"px",left:9*Math.cos(a)+"px","animation-delay":i}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:function(){return{r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}}}},crescent:{dur:750,circles:1,fn:function(){return{r:26,style:{}}}},dots:{dur:750,circles:3,fn:function(e,t){return{r:6,style:{left:9-9*t+"px","animation-delay":-110*t+"ms"}}}},lines:{dur:1e3,lines:12,fn:function(e,t,n){return{y1:17,y2:29,style:{transform:"rotate(".concat(30*t+(t<6?180:-180),"deg)"),"animation-delay":e*t/n-e+"ms"}}}},"lines-small":{dur:1e3,lines:12,fn:function(e,t,n){return{y1:12,y2:20,style:{transform:"rotate(".concat(30*t+(t<6?180:-180),"deg)"),"animation-delay":e*t/n-e+"ms"}}}}}},mpJo:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("mrSG"),i=n("tLCv"),a=n("lGQG"),o=n("jtHE"),s=n("DMZm"),c=n("SxV6"),u=n("kXdw"),l=n("n90K"),f=n("8Y7J"),h=function(){var e=function(){function e(t,n,r,i,a,s){_classCallCheck(this,e),this.authService=t,this.stitchService=n,this.subscriptionsService=r,this.sellersService=i,this.storageService=a,this.ngZone=s,this.myAdsSource$=new o.a(1),this.myAds$=this.myAdsSource$.asObservable(),this.allAdsSource$=new o.a(1),this.allAds$=this.allAdsSource$.asObservable(),this.init()}return _createClass(e,[{key:"init",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stitchService.checkInitedDb();case 2:this.adsCollection=this.stitchService.db.collection("ads");case 3:case"end":return e.stop()}}),e,this)})))}},{key:"add",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.authService.getStitchAuth();case 2:return e.dateCreate=new Date,e.user=this.authService.getLogin(),e.active=!0,e.archive=!1,e.aliasCategory=this.subscriptionsService.transliterate("".concat(e.category,"_").concat(e.model)),t.next=9,this.stitchService.callFunction("newAd",e);case 9:return n=t.sent,t.abrupt("return",(this.getMyRefresh(),n));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"delete",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.stitchService.callFunction("deleteAd",e);case 2:this.getMyRefresh();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"update",value:function(e,t){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={_id:this.stitchService.bsonObject(e)},i={$set:t},n.next=3,this.adsCollection.updateOne(r,i);case 3:this.getMyRefresh();case 4:case"end":return n.stop()}}),n,this)})))}},{key:"getMyRefresh",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authService.getStitchAuth();case 2:return t={user:this.authService.getLogin()},e.next=5,this.adsCollection.find(t,{sort:{dateCreate:-1}}).toArray();case 5:return n=e.sent,this.myAdsSource$.next(n),e.next=9,this.storageService.setIonicStorage("myAds",JSON.stringify(n));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"getMyCache",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,this.storageService.getIonicStorage("myAds");case 3:e.t1=e.sent,t=e.t0.parse.call(e.t0,e.t1),this.myAdsSource$.next(t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getMy",value:function(){return this.getMyRefresh(),this.myAds$}},{key:"getById",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.authService.getStitchAuth();case 2:return n={_id:this.stitchService.bsonObject(e)},t.next=5,this.adsCollection.findOne(n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"watchAd",value:function(e){return this.stitchService.watch$(this.adsCollection,[this.stitchService.bsonObject(e)])}},{key:"watchAllAds",value:function(e,t){var n=[{"fullDocument.region":"AllCountry"}],r={"fullDocument.archive":!1};return(e=e.map((function(e){return{"fullDocument.aliasCategory":e.aliasCategory}}))).length&&(r.$and=[{$or:e},{operationType:"delete"}]),t.region&&e.length&&(n.push({"fullDocument.region":t.region}),r={$or:[{$and:[{$or:e},{$or:n}],"fullDocument.archive":!1},{operationType:"delete"}]}),this.stitchService.watch$(this.adsCollection,r)}},{key:"getInfoSellerAds",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.subscriptionsService.get();case 2:return t=e.sent,n=t.map((function(e){return{aliasCategory:e.category,min:e.min,max:e.max,state:e.state}})),t=n.map((function(e){return{aliasCategory:e.aliasCategory}})),e.t0=t,e.next=8,this.sellersService.getMy().pipe(Object(c.a)()).toPromise();case 8:return e.t1=e.sent,e.t2=n,e.abrupt("return",{subscriptions:e.t0,seller:e.t1,subscriptionsYears:e.t2});case 11:case"end":return e.stop()}}),e,this)})))}},{key:"getAllRefresh",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a,o,s,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authService.getStitchAuth();case 2:return e.next=4,this.getInfoSellerAds();case 4:if(t=e.sent,n=t.subscriptions,r=t.seller,i=t.subscriptionsYears,a=[{region:"AllCountry"}],o={archive:!1},n.length&&(o.$or=n),r.region&&n.length&&(a.push({region:r.region}),o={$and:[{$or:n},{$or:a}],archive:!1}),s=[],e.t0=n.length,!e.t0){e.next=17;break}return e.next=16,this.adsCollection.find(o,{sort:{dateCreate:-1}}).toArray();case 16:s=e.sent;case 17:return this.ngZone.run((function(){s=(s=s.filter((function(e){var t=i.find((function(t){return t.aliasCategory===e.aliasCategory})),n=t.min?t.min:(new Date).getFullYear()-100;return(t.max?t.max:(new Date).getFullYear())>=e.year&&n<=e.year}))).filter((function(e){return!!i.find((function(t){return!t.state||"Any"==t.state||t.state==e.state||"Any"==e.state}))})),c.allAdsSource$.next(s)})),e.next=20,this.storageService.setIonicStorage("allAds",JSON.stringify(s));case 20:case"end":return e.stop()}}),e,this)})))}},{key:"getAllCache",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,this.storageService.getIonicStorage("allAds");case 3:e.t1=e.sent,t=e.t0.parse.call(e.t0,e.t1),this.allAdsSource$.next(t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getAll",value:function(){return this.getAllRefresh(),this.allAds$}},{key:"getByIdCache",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,this.storageService.getIonicStorage("allAds");case 3:if(t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1),t.t2=n&&n.length,t.t2){t.next=12;break}return t.t3=JSON,t.next=10,this.storageService.getIonicStorage("myAds");case 10:t.t4=t.sent,n=t.t3.parse.call(t.t3,t.t4);case 12:if(!n||!n.length){t.next=14;break}return t.abrupt("return",n.find((function(t){return t._id.toString()==e})));case 14:case"end":return t.stop()}}),t,this)})))}}]),e}();return e.ngInjectableDef=f.Qb({factory:function(){return new e(f.Rb(a.a),f.Rb(i.a),f.Rb(s.a),f.Rb(u.a),f.Rb(l.a),f.Rb(f.x))},token:e,providedIn:"root"}),e}()},qULd:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return s}));var r={getEngine:function(){var e=window;return e.TapticEngine||e.Capacitor&&e.Capacitor.isPluginAvailable("Haptics")&&e.Capacitor.Plugins.Haptics},available:function(){return!!this.getEngine()},isCordova:function(){return!!window.TapticEngine},isCapacitor:function(){return!!window.Capacitor},impact:function(e){var t=this.getEngine();if(t){var n=this.isCapacitor()?e.style.toUpperCase():e.style;t.impact({style:n})}},notification:function(e){var t=this.getEngine();if(t){var n=this.isCapacitor()?e.style.toUpperCase():e.style;t.notification({style:n})}},selection:function(){this.impact({style:"light"})},selectionStart:function(){var e=this.getEngine();e&&(this.isCapacitor()?e.selectionStart():e.gestureSelectionStart())},selectionChanged:function(){var e=this.getEngine();e&&(this.isCapacitor()?e.selectionChanged():e.gestureSelectionChanged())},selectionEnd:function(){var e=this.getEngine();e&&(this.isCapacitor()?e.selectionEnd():e.gestureSelectionEnd())}},i=function(){r.selection()},a=function(){r.selectionStart()},o=function(){r.selectionChanged()},s=function(){r.selectionEnd()},c=function(e){r.impact(e)}}}]);