function _get(e,t,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var r=_superPropBase(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var i=[],r=!0,n=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(l){n=!0,s=l}finally{try{r||null==o.return||o.return()}finally{if(n)throw s}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,r=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"/9Oo":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("8Y7J");i("ndxW");var n=function(){function e(t){_classCallCheck(this,e),this.stateService=t,this._sellers=[],this.loadMoreEmitter=new r.m,this.sellersArray=[],this.sellersLoaded=!1}return _createClass(e,[{key:"trackByFn",value:function(e,t){return t._id.toString()}},{key:"ngOnChanges",value:function(){console.log("New data: ",this.sellersArray)}},{key:"ngOnInit",value:function(){var e=this;this.stateService.stateChanged.subscribe((function(t){console.log("New sellers: ",t),e._sellers=t.map((function(t){return Object.assign({},t,{sub:t.subscriptions.filter((function(t){return t.category===e.category}))[0]})}))}))}},{key:"callPhone",value:function(e){window.location.href="tel:"+e}},{key:"loadMore",value:function(e){console.log(e),this.loadMoreEmitter.emit(e)}},{key:"ngOnDestroy",value:function(){}},{key:"sellers",set:function(e){var t=this;e&&this.category&&(this._sellers=e.map((function(e){return Object.assign({},e,{sub:e.subscriptions.filter((function(e){return e.category===t.category}))[0]})})))}}]),e}()},"/LYu":function(e,t,i){"use strict";var r=i("mrSG"),n=(i("usHs"),i("DMZm"),i("P64T"),i("SxV6")),s=i("GJmQ");i("kXdw");var a=function e(){_classCallCheck(this,e)},o=function e(){_classCallCheck(this,e)};i("KSpV"),i("/lBd"),i("2rUM"),i("Hzbo"),i("BtvW"),i("ndxW"),i.d(t,"a",(function(){return l}));var l=function(){function e(t,i,r,n,s,l,c,u,h,f,p){_classCallCheck(this,e),this.coreService=t,this.offersService=i,this.subscriptionsService=r,this.sellersService=n,this.referencesService=s,this.translatesService=l,this.messagesService=c,this.ngZone=u,this.cdr=h,this.advService=f,this.stateService=p,this.alive=!0,this.loaded=!1,this.seller=new a,this.client=new a,this.filter="offers",this.offer=new o,this.offers=[],this.sellersLoading=!0,this.sellersLoaded=!1,this.offersLoading=!0,this.customPatterns={A:{pattern:new RegExp("^[0-9]*[.]?[0-9]*?$")}},this.disableBtn=!1,this.sellers=[],this.subscriptionsOffset=0,this.showSellers=!0}return _createClass(e,[{key:"responseChange",value:function(e){e.target.value||"0"!=e.key||(e.stopPropagation(),e.preventDefault(),this.offer.price="")}},{key:"goToAdv",value:function(e){window.location.href=e}},{key:"ChangeSelect",value:function(e,t){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=e.region,!i.t0){i.next=6;break}return i.next=4,this.referencesService.getCityByRegion(e.region);case 4:this.cities=i.sent,e.city=t?null:e.city;case 6:case"end":return i.stop()}}),i,this)})))}},{key:"responseInput",value:function(e){e.data||"0"!==e.target.value[0]?"0"===e.data&&"0"===e.target.value[0]&&(e.target.value=e.target.value.replace(/^0/,""),this.offer.price=e.target.value):(e.target.value=e.target.value.replace(/^0+/,""),this.offer.price=e.target.value)}},{key:"init",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.myAd){e.next=4;break}this.advService.getRandom().then((function(e){t.adv=e})),this.offersService.getOffersByAd(this.ad._id.toString(),!1,this.ad.aliasCategory).then((function(e){t.getSubscriptions(),t.offers=e,e.forEach((function(e){console.log("Element: ",e)})),t.offersLoading=!1})),e.next=21;break;case 4:if(e.t0=this.myAd,e.t0){e.next=21;break}return console.log("Else if"),e.next=9,this.offersService.getOfferCacheByAd(this.ad._id.toString());case 9:return this.offers=e.sent,this.offers&&(this.loaded=!0),e.next=13,this.sellersService.getMy().pipe(Object(n.a)()).toPromise();case 13:return this.seller=e.sent,e.next=16,this.sellersService.getByUid(this.ad.user);case 16:return this.client=e.sent,e.next=19,this.offersService.getOffersByAd(this.ad._id.toString(),!0);case 19:this.offers=e.sent,this.loaded=!0;case 21:case"end":return e.stop()}}),e,this)})))}},{key:"segmentChanged",value:function(e){this.filter=e.detail.value}},{key:"callPhone",value:function(e){window.location.href="tel:"+e}},{key:"getSubscriptions",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.subscriptionsService.getSubscriptionCount(this.ad.aliasCategory,this.ad.region,this.ad.year,this.ad.state);case 2:return this.subscriptions=e.sent,"Any"!==this.ad.state&&(this.subscriptions=this.subscriptions.filter((function(e){return e.state==t.ad.state||!e.state||"Any"==e.state}))),this.uids=this.subscriptions.map((function(e){return e.user})),this.sellersService.getSellerCountByUid(null,this.uids).then((function(e){t.subsCount=e[0]?e[0].count:0,t.loaded=0==t.offersLoading,t.sellersLoading=!1})),e.next=8,this.sellersService.getSellerByUid(this.ad._id.toString(),this.uids,this.subscriptionsOffset);case 8:this.sellers=e.sent,this.sellersLoaded=!0,this.loaded=!0;case 11:case"end":return e.stop()}}),e,this)})))}},{key:"loadMoreSubscriptions",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Load more"),console.log("Offset: ",this.subscriptionsOffset),this.subscriptionsOffset+=10,console.log("Offset: ",this.subscriptionsOffset),this.sellersService.getSellerByUid(this.ad._id.toString(),this.uids,this.subscriptionsOffset).then((function(t){var r;console.log("res: ",t),(r=i.sellers).push.apply(r,_toConsumableArray(t)),i.showSellers=!1,i.showSellers=!0,console.log("Sellers: ",i.sellers),e.target.complete(),i.stateService.stateChanged.next(i.sellers)}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"checkOffer",value:function(e){return!e.price&&!e.text||this.disableBtn}},{key:"checkSeller",value:function(e){var t=e.phone.length<this.phoneLength(this.translatesService.getWord("NumberLength"));return!e.name||!e.city||t||!e.address||this.disableBtn}},{key:"ngOnInit",value:function(){var e=this;this.init(),this.referencesService.getAllRegions().then((function(t){e.regions=t})),this.coreService.dataRefresh.pipe(Object(s.a)((function(){return e.alive}))).subscribe((function(){return e.init()}))}},{key:"ngOnDestroy",value:function(){this.alive=!1}},{key:"phoneLength",value:function(e){return parseInt(e)}},{key:"addSellerAndOffer",value:function(e,t){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.disableBtn=!0,i.next=3,this.sellersService.update(e);case 3:return i.next=5,this.addOffer(t);case 5:case"end":return i.stop()}}),i,this)})))}},{key:"getUnread",value:function(e,t){return this.messagesService.getUnreadItem(e,t)}},{key:"addOffer",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.disableBtn=!0,t.next=3,this.coreService.presentLoading("SendOffer");case 3:return e.ad=this.ad._id.toString(),e.text=this.offer.text&&this.offer.text.length?"".concat(e.text).concat(this.translatesService.getWord("responseTemplate")):""+this.translatesService.getWord("notTextResponse"),t.next=7,this.offersService.add(e,this.ad.user);case 7:return this.coreService.dataRefresh.next(),t.next=10,this.coreService.dismissLoading();case 10:this.disableBtn=!1;case 11:case"end":return t.stop()}}),t,this)})))}},{key:"notHaveOffer",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.disableBtn=!0,t.next=3,this.coreService.presentLoading("SendOffer");case 3:return e.ad=this.ad._id.toString(),e.text=""+this.translatesService.getWord("NotAvailableTextResponse"),e.not_available=!0,t.next=8,this.offersService.add(e,this.ad.user);case 8:return this.coreService.dataRefresh.next(),t.next=11,this.coreService.dismissLoading();case 11:this.disableBtn=!1;case 12:case"end":return t.stop()}}),t,this)})))}}]),e}()},"1jS7":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("8Y7J");i("jT/F");var n=function(){function e(t){_classCallCheck(this,e),this.uploadService=t,this.fileUploaded=new r.m}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.file&&(this.uploadService.pushFileToStorage(this.file),this.uploadService.completed$.subscribe((function(t){e.fileUploaded.emit(t)})))}}]),e}()},"4Em8":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function e(){_classCallCheck(this,e)}},"68W0":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("mrSG"),n=i("8Y7J");i("Pn9U"),i("t8sF"),i("AcVp"),i("2rUM");var s=function(){function e(t,i,r,s,a,o){_classCallCheck(this,e),this.platform=t,this.camera=i,this.file=r,this.backgroundMode=s,this.actionSheetController=a,this.translatesService=o,this.name="cloud-upload",this.selectedFile=new n.m,this.options={quality:50,destinationType:this.camera.DestinationType.FILE_URI,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,targetWidth:800,targetHeight:800,correctOrientation:!0},this.optionsBackground={id:-1,title:this.translatesService.getWord("Load"),text:this.translatesService.getWord("WaitImage"),hidden:!1,silent:!1,sticky:!0,resume:!1,foreground:!0}}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"actionSheetChoiceFile",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.platform.is("cordova")){e.next=8;break}return e.next=3,this.actionSheetController.create({header:this.translatesService.getWord("PhotoSource"),buttons:[{text:this.translatesService.getWord("Camera"),icon:"camera",handler:function(){i.selectImage(i.camera.PictureSourceType.CAMERA)}},{text:this.translatesService.getWord("Album"),icon:"image",handler:function(){i.selectImage(i.camera.PictureSourceType.PHOTOLIBRARY)}},{text:this.translatesService.getWord("Cancel"),icon:"close",role:"cancel"}]});case 3:return t=e.sent,e.next=6,t.present();case 6:e.next=9;break;case 8:this.fileUploadWeb.nativeElement.click();case 9:case"end":return e.stop()}}),e,this)})))}},{key:"selectImage",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.backgroundMode.setDefaults(this.optionsBackground),this.backgroundMode.enable(),this.options.sourceType=e,this.options.allowEdit=e===this.camera.PictureSourceType.PHOTOLIBRARY,this.camera.getPicture(this.options).then((function(e){return r.__awaiter(i,void 0,void 0,regeneratorRuntime.mark((function t(){var i,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.makeFileIntoBlob(e);case 2:i=t.sent,this.returnFile(i.imgBlob),setTimeout((function(){r.backgroundMode.disable()}),2e3);case 4:case"end":return t.stop()}}),t,this)})))})).catch((function(){setTimeout((function(){i.backgroundMode.disable()}),2e3)}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"makeFileIntoBlob",value:function(e){var t=this;return new Promise((function(i,r){var n="";t.file.resolveLocalFilesystemUrl(e).then((function(e){var i=e.name,r=e.nativeURL,s=r.substring(0,r.lastIndexOf("/"));return n=i,t.file.readAsArrayBuffer(s,i)})).then((function(e){var t=new Blob([e],{type:"image/jpeg"});i({fileName:n,imgBlob:t})})).catch((function(e){return r(e)}))}))}},{key:"returnFile",value:function(e){this.selectedFile.emit(e)}}]),e}()},"6XD3":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e){if(Array.isArray(e))return e.sort((function(e,t){return e.sub.vip===t.sub.vip?0:e.sub.vip?-1:t.sub.vip?1:void 0})),e}}]),e}()},BtvW:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i("mrSG"),n=i("n90K"),s=i("SxV6"),a=i("8Y7J"),o=i("PVcy"),l=function(){var e=function(){function e(t,i){_classCallCheck(this,e),this.afd=t,this.storageService=i}return _createClass(e,[{key:"getRandom",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storageService.get("language");case 2:return t=e.sent,e.next=5,this.afd.list("/advertising",(function(e){return e.orderByChild("lang").equalTo(t)})).snapshotChanges().pipe(Object(s.a)()).toPromise();case 5:return i=e.sent.map((function(e){return Object.assign({id:e.key},e.payload.val())})),e.abrupt("return",i[Math.floor(Math.random()*i.length)]);case 7:case"end":return e.stop()}}),e,this)})))}}]),e}();return e.ngInjectableDef=a.Qb({factory:function(){return new e(a.Rb(o.a),a.Rb(n.a))},token:e,providedIn:"root"}),e}()},EFqu:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){function e(t){_classCallCheck(this,e),this.modalController=t,this.sliderOpts={centeredSlides:!0,allowTouchMove:!1}}return _createClass(e,[{key:"close",value:function(){this.modalController.dismiss()}}]),e}()},Ewk1:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e){if(Array.isArray(e))return e.sort((function(e,t){return e.rating<t.rating?1:e.rating>t.rating?-1:0})),e}}]),e}()},GJmQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("7o/Q");function n(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(i){return i.lift(new s(e,t))}}var s=function(){function e(t,i){_classCallCheck(this,e),this.predicate=t,this.inclusive=i}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new a(e,this.predicate,this.inclusive))}}]),e}(),a=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,r,n){var s;return _classCallCheck(this,i),(s=t.call(this,e)).predicate=r,s.inclusive=n,s.index=0,s}return _createClass(i,[{key:"_next",value:function(e){var t,i=this.destination;try{t=this.predicate(e,this.index++)}catch(r){return void i.error(r)}this.nextOrComplete(e,t)}},{key:"nextOrComplete",value:function(e,t){var i=this.destination;Boolean(t)?i.next(e):(this.inclusive&&i.next(e),i.complete())}}]),i}(r.a)},KSpV:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i("mrSG"),n=i("lGQG"),s=i("tLCv"),a=i("kXdw"),o=i("Hzbo"),l=i("4Em8"),c=i("2Vo4"),u=i("lJxs"),h=i("n90K"),f=i("8Y7J"),p=function(){var e=function(){function e(t,i,r,n,s,a){_classCallCheck(this,e),this.authService=t,this.stitchService=i,this.sellersService=r,this.messagesService=n,this.storageService=s,this.ngZone=a,this.myOffers=new c.a([]),this.init()}return _createClass(e,[{key:"init",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stitchService.checkInitedDb();case 2:this.offersCollection=this.stitchService.db.collection("offers");case 3:case"end":return e.stop()}}),e,this)})))}},{key:"getOffersCache",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=JSON,e.next=3,this.storageService.getIonicStorage("offers");case 3:e.t1=e.sent,t=e.t0.parse.call(e.t0,e.t1),this.myOffers.next(t);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getOfferCacheByAd",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=JSON,t.next=3,this.storageService.getIonicStorage("offers_"+e);case 3:if(t.t1=t.sent,!(i=t.t0.parse.call(t.t0,t.t1))||!i.length){t.next=8;break}return r=i.find((function(t){return t.ad==e})),t.abrupt("return",r?[r]:null);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"add",value:function(e,t){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return e.dateCreate=new Date,e.user=this.authService.getLogin(),i.next=3,this.stitchService.callFunction("newOffer",e);case 3:return r=i.sent,(n=new l.a).ad=e.ad,n.to=t,n.offer=r.toString(),n.text=e.text,i.next=11,this.messagesService.add(n,!1);case 11:case"end":return i.stop()}}),i,this)})))}},{key:"getOffersByAd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function n(){var s,a,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.authService.getStitchAuth();case 2:return s={ad:e},t&&(s.user=this.authService.getLogin()),a={sort:{dateCreate:-1}},n.abrupt("return",new Promise((function(e,t){e(o.offersCollection.find(s,a).toArray())})).then((function(e){console.log("Offers: ",e);var t=new Map;return e.forEach((function(e){t.set(e.user,{seller:null})})),o.sellersService.getSellerByUidVisibleOmitted(null,Array.from(t.keys())).then((function(n){n.forEach((function(e){t.get(e.uid).seller=e}));var s=[];return e.forEach((function(e,n){return r.__awaiter(o,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:s.push(Object.assign({},e,{userInfo:t.get(e.user).seller,sub:null!=t.get(e.user).seller.subscriptions.filter((function(e){return e.category==i}))[0]?t.get(e.user).seller.subscriptions.filter((function(e){return e.category==i}))[0]:{vip:!1,rating:0}}));case 1:case"end":return r.stop()}}),r)})))})),s}))})));case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getOffersBySellerInit",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authService.getStitchAuth();case 2:this.getOffersBySeller(),t={"fullDocument.user":this.authService.getLogin()},this.stitchService.watch$(this.offersCollection,t).subscribe((function(e){var t=e.fullDocument;if("insert"==e.operationType){var r=[].concat(_toConsumableArray(i.myOffers.getValue()),[t]);i.ngZone.run((function(){i.myOffers.next(r),i.storageService.setIonicStorage("offers",JSON.stringify(r))}))}}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getOffersBySeller",value:function(){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.getOffersCache(),(t=new Date).setDate(t.getDate()-10),i={user:this.authService.getLogin(),dateCreate:{$gte:t}},e.next=6,this.offersCollection.find(i,{sort:{dateCreate:-1}}).toArray();case 6:return r=e.sent,this.myOffers.next(r),e.next=10,this.storageService.setIonicStorage("offers",JSON.stringify(r));case 10:case"end":return e.stop()}}),e,this)})))}},{key:"getOfferItemByAd",value:function(e){return this.myOffers.pipe(Object(u.a)((function(t){return t.find((function(t){return t.ad===e}))})))}},{key:"watch",value:function(e){return this.stitchService.watch$(this.offersCollection,{"fullDocument.ad":e})}}]),e}();return e.ngInjectableDef=f.Qb({factory:function(){return new e(f.Rb(n.a),f.Rb(s.a),f.Rb(a.a),f.Rb(o.a),f.Rb(h.a),f.Rb(f.x))},token:e,providedIn:"root"}),e}()},SZog:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i("mrSG"),n=i("8Y7J"),s=(i("jT/F"),i("EFqu"));i("2rUM");var a=function(){function e(t,i,r,s,a){_classCallCheck(this,e),this.uploadService=t,this.modalController=i,this.cdr=r,this.actionSheetController=s,this.translatesService=a,this.files=[],this.readOnly=!1,this.imagesChange=new n.m,this.allow=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.files||(this.files=[]),this.checkCount()}},{key:"ngOnDestroy",value:function(){this.cdr.detach()}},{key:"checkCount",value:function(){this.allow=!this.files||this.files.length<this.count,this.cdr.detectChanges()}},{key:"openPreview",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalController.create({component:s.a,componentProps:{img:e}});case 2:return i=t.sent,t.next=5,i.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"actionSheetChoiceAction",value:function(e){return r.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.readOnly){t.next=2;break}return t.abrupt("return",this.openPreview(e));case 2:return t.next=4,this.actionSheetController.create({header:this.translatesService.getWord("Action"),buttons:[{text:this.translatesService.getWord("FullScreen"),icon:"open",handler:function(){r.openPreview(e)}},{text:this.translatesService.getWord("Delete"),role:"destructive",icon:"trash",handler:function(){r.files.splice(r.files.indexOf(e),1),r.checkCount()}},{text:this.translatesService.getWord("Cancel"),icon:"close",role:"cancel"}]});case 4:return i=t.sent,t.next=7,i.present();case 7:case"end":return t.stop()}}),t,this)})))}},{key:"onFileSelect",value:function(e){this.selectedFile=e,this.cdr.detectChanges()}},{key:"onFileUploaded",value:function(e){this.selectedFile=null,this.images=this.files.concat(e),this.checkCount()}},{key:"images",get:function(){return this.files},set:function(e){this.files=e,this.imagesChange.emit(this.files),this.checkCount()}}]),e}()},bOtU:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return p})),i.d(t,"d",(function(){return f})),i.d(t,"e",(function(){return a})),i.d(t,"f",(function(){return d})),i.d(t,"g",(function(){return v})),i.d(t,"h",(function(){return s})),i.d(t,"i",(function(){return l}));var r=i("8Y7J"),n=i("mrSG"),s=new r.o("config"),a=new r.o("NEW_CONFIG"),o=new r.o("INITIAL_CONFIG"),l={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:".",clearIfNotMatch:!1,showTemplate:!1,showMaskTyped:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:void 0,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},c=["Hh:m0:s0","Hh:m0","m0:s0"],u=["percent","Hh","s0","m0","separator","d0/M0/0000","d0/M0","d0","M0"],h=function(){function e(t){var i=this;_classCallCheck(this,e),this._config=t,this.maskExpression="",this.actualValue="",this.shownMaskExpression="",this._formatWithSeparators=function(e,t,r,n){var s=e.split(r),a=s.length>1?"".concat(r).concat(s[1]):"",o=s[0],l=i.separatorLimit.replace(/\s/g,"");l&&+l&&(o="-"===o[0]?"-"+o.slice(1,o.length).slice(0,l.length):o.slice(0,l.length));for(var c=/(\d+)(\d{3})/;c.test(o);)o=o.replace(c,"$1"+t+"$2");return void 0===n?o+a:0===n?o:o+a.substr(0,n+1)},this.percentage=function(e){return Number(e)>=0&&Number(e)<=100},this.getPrecision=function(e){var t=e.split(".");return t.length>1?Number(t[t.length-1]):1/0},this.checkInputPrecision=function(e,t,r){if(t<1/0){var n=new RegExp(i._charToRegExpExpression(r)+"\\d{".concat(t,"}.*$")),s=e.match(n);(s&&s[0].length-1>t||0===t&&e.endsWith(r))&&(e=e.substring(0,e.length-1))}return e},this._shift=new Set,this.clearIfNotMatch=this._config.clearIfNotMatch,this.dropSpecialCharacters=this._config.dropSpecialCharacters,this.maskSpecialCharacters=this._config.specialCharacters,this.maskAvailablePatterns=this._config.patterns,this.prefix=this._config.prefix,this.suffix=this._config.suffix,this.thousandSeparator=this._config.thousandSeparator,this.decimalMarker=this._config.decimalMarker,this.hiddenInput=this._config.hiddenInput,this.showMaskTyped=this._config.showMaskTyped,this.placeHolderCharacter=this._config.placeHolderCharacter,this.validation=this._config.validation,this.separatorLimit=this._config.separatorLimit,this.allowNegativeNumbers=this._config.allowNegativeNumbers}return _createClass(e,[{key:"applyMaskWithPattern",value:function(e,t){var i=_slicedToArray(t,2),r=i[0],n=i[1];return this.customPattern=n,this.applyMask(e,r)}},{key:"applyMask",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(null==e||void 0===t)return"";var n=0,s="",a=!1,o=!1,l=1,c=!1;e.slice(0,this.prefix.length)===this.prefix&&(e=e.slice(this.prefix.length,e.length)),this.suffix&&e.endsWith(this.suffix)&&(e=e.slice(0,e.length-this.suffix.length));var u=e.toString().split("");if("IP"===t&&(this.ipError=!!(u.filter((function(e){return"."===e})).length<3&&u.length<7),t="099.099.099.099"),t.startsWith("percent")){if(e.match("[a-z]|[A-Z]")||e.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/]/)){e=this._stripToDecimal(e);var h=this.getPrecision(t);e=this.checkInputPrecision(e,h,".")}if(e.indexOf(".")>0&&!this.percentage(e.substring(0,e.indexOf(".")))){var f=e.substring(0,e.indexOf(".")-1);e="".concat(f).concat(e.substring(e.indexOf("."),e.length))}s=this.percentage(e)?e:e.substring(0,e.length-1)}else if(t.startsWith("separator")){(e.match("[w\u0430-\u044f\u0410-\u042f]")||e.match("[\u0401\u0451\u0410-\u044f]")||e.match("[a-z]|[A-Z]")||e.match(/[-@#!$%\\^&*()_\xa3\xac'+|~=`{}\[\]:";<>.?\/]/)||e.match("[^A-Za-z0-9,]"))&&(e=this._stripToDecimal(e)),e=e.length>1&&"0"===e[0]&&e[1]!==this.decimalMarker?e.slice(1,e.length):e;var p=this._charToRegExpExpression(this.thousandSeparator),d=this._charToRegExpExpression(this.decimalMarker),v='@#!$%^&*()_+|~=`{}\\[\\]:\\s,";<>?\\/'.replace(p,"").replace(d,""),g=new RegExp("["+v+"]");e.match(g)&&(e=e.substring(0,e.length-1));var m=this.getPrecision(t),k=(e=this.checkInputPrecision(e,m,this.decimalMarker)).replace(new RegExp(p,"g"),""),_=(s=this._formatWithSeparators(k,this.thousandSeparator,this.decimalMarker,m)).indexOf(",")-e.indexOf(","),S=s.length-e.length;if(S>0&&","!==s[i]){o=!0;var y=0;do{this._shift.add(i+y),y++}while(y<S)}else 0!==_&&i>0&&!(s.indexOf(",")>=i&&i>3)||!(s.indexOf(".")>=i&&i>3)&&S<=0?(this._shift.clear(),o=!0,l=S,this._shift.add(i+=S)):this._shift.clear()}else for(var x=0,b=u[0];x<u.length&&n!==t.length;b=u[++x])if(this._checkSymbolMask(b,t[n])&&"?"===t[n+1])s+=b,n+=2;else if("*"===t[n+1]&&a&&this._checkSymbolMask(b,t[n+2]))s+=b,n+=3,a=!1;else if(this._checkSymbolMask(b,t[n])&&"*"===t[n+1])s+=b,a=!0;else if("?"===t[n+1]&&this._checkSymbolMask(b,t[n+2]))s+=b,n+=3;else if(this._checkSymbolMask(b,t[n])||this.hiddenInput&&this.maskAvailablePatterns[t[n]]&&this.maskAvailablePatterns[t[n]].symbol===b){if("H"===t[n]&&Number(b)>2){n+=1;var C=/[*?]/g.test(t.slice(0,n))?u.length:n;this._shift.add(C+this.prefix.length||0),x--;continue}if("h"===t[n]&&"2"===s&&Number(b)>3){n+=1,x--;continue}if("m"===t[n]&&Number(b)>5){n+=1;var w=/[*?]/g.test(t.slice(0,n))?u.length:n;this._shift.add(w+this.prefix.length||0),x--;continue}if("s"===t[n]&&Number(b)>5){n+=1;var O=/[*?]/g.test(t.slice(0,n))?u.length:n;this._shift.add(O+this.prefix.length||0),x--;continue}var E=31;if("d"===t[n]&&(Number(e.slice(n,n+2))>E||"/"===e[n+1])){n+=1;var R=/[*?]/g.test(t.slice(0,n))?u.length:n;this._shift.add(R+this.prefix.length||0),x--;continue}if("M"===t[n]){var M=12,I=0===n&&(Number(b)>2||Number(e.slice(n,n+2))>M||"/"===e[n+1]),V=e.slice(n-3,n-1).includes("/")&&("/"===e[n-2]&&Number(e.slice(n-1,n+1))>M&&"/"!==e[n]||"/"===e[n]||"/"===e[n-3]&&Number(e.slice(n-2,n))>M&&"/"!==e[n-1]||"/"===e[n-1]),P=Number(e.slice(n-3,n-1))<=E&&!e.slice(n-3,n-1).includes("/")&&"/"===e[n-1]&&(Number(e.slice(n,n+2))>M||"/"===e[n+1]),A=Number(e.slice(n-3,n-1))>E&&!e.slice(n-3,n-1).includes("/")&&!e.slice(n-2,n).includes("/")&&Number(e.slice(n-2,n))>M,T=Number(e.slice(n-3,n-1))<=E&&!e.slice(n-3,n-1).includes("/")&&"/"!==e[n-1]&&Number(e.slice(n-1,n+1))>M;if(I||V||P||A||T){n+=1;var N=/[*?]/g.test(t.slice(0,n))?u.length:n;this._shift.add(N+this.prefix.length||0),x--;continue}}s+=b,n++}else if(-1!==this.maskSpecialCharacters.indexOf(t[n])){s+=t[n],n++;var L=/[*?]/g.test(t.slice(0,n))?u.length:n;this._shift.add(L+this.prefix.length||0),x--}else this.maskSpecialCharacters.indexOf(b)>-1&&this.maskAvailablePatterns[t[n]]&&this.maskAvailablePatterns[t[n]].optional?(u[n]&&"099.099.099.099"!==t&&(s+=u[n]),n++,x--):"*"===this.maskExpression[n+1]&&this._findSpecialChar(this.maskExpression[n+2])&&this._findSpecialChar(b)===this.maskExpression[n+2]&&a||"?"===this.maskExpression[n+1]&&this._findSpecialChar(this.maskExpression[n+2])&&this._findSpecialChar(b)===this.maskExpression[n+2]&&a?(n+=3,s+=b):this.showMaskTyped&&this.maskSpecialCharacters.indexOf(b)<0&&b!==this.placeHolderCharacter&&(c=!0);s.length+1===t.length&&-1!==this.maskSpecialCharacters.indexOf(t[t.length-1])&&(s+=t[t.length-1]);for(var j=i+1;this._shift.has(j);)l++,j++;var B=this._shift.has(i)?l:0;c&&B--,r(B,o),l<0&&this._shift.clear();var F="".concat(this.prefix).concat(s).concat(this.suffix);return 0===s.length&&(F="".concat(this.prefix).concat(s)),F}},{key:"_findSpecialChar",value:function(e){return this.maskSpecialCharacters.find((function(t){return t===e}))}},{key:"_checkSymbolMask",value:function(e,t){return this.maskAvailablePatterns=this.customPattern?this.customPattern:this.maskAvailablePatterns,this.maskAvailablePatterns[t]&&this.maskAvailablePatterns[t].pattern&&this.maskAvailablePatterns[t].pattern.test(e)}},{key:"_stripToDecimal",value:function(e){return e.split("").filter((function(e,t){return e.match("^-?\\d")||"."===e||","===e||"-"===e&&0===t})).join("")}},{key:"_charToRegExpExpression",value:function(e){return" "===e?"\\s":"[\\^$.|?*+()".indexOf(e)>=0?"\\"+e:e}}]),e}(),f=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,r,n,s){var a;return _classCallCheck(this,i),(a=t.call(this,r)).document=e,a._config=r,a._elementRef=n,a._renderer=s,a.maskExpression="",a.isNumberValue=!1,a.placeHolderCharacter="_",a.maskIsShown="",a.selStart=null,a.selEnd=null,a.onChange=function(e){},a._formElement=a._elementRef.nativeElement,a}return _createClass(i,[{key:"applyMask",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(!t)return e;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():"","IP"===this.maskExpression&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(e||"#")),!e&&this.showMaskTyped)return this.formControlResult(this.prefix),this.prefix+this.maskIsShown;var a=e&&"number"==typeof this.selStart?e[this.selStart]:"",o="";if(void 0!==this.hiddenInput){var l=this.actualValue.split("");""!==e&&l.length?"number"==typeof this.selStart&&"number"==typeof this.selEnd&&(e.length>l.length?l.splice(this.selStart,0,a):e.length<l.length&&(l.length-e.length==1?l.splice(this.selStart-1,1):l.splice(this.selStart,this.selEnd-this.selStart))):l=[],o=this.actualValue.length?this.shiftTypedSymbols(l.join("")):e}o=Boolean(o)&&o.length?o:e;var c=_get(_getPrototypeOf(i.prototype),"applyMask",this).call(this,o,t,n,s);if(this.actualValue=this.getActualValue(c),"."===this.thousandSeparator&&"."===this.decimalMarker&&(this.decimalMarker=","),this.maskExpression.startsWith("separator")&&!0===this.dropSpecialCharacters&&(this.maskSpecialCharacters=this.maskSpecialCharacters.filter((function(e){return e!==r.decimalMarker}))),this.formControlResult(c),!this.showMaskTyped)return this.hiddenInput&&c&&c.length?this.hideInput(c,this.maskExpression):c;var u=this.prefix+this.maskIsShown;return c+("IP"===this.maskExpression?u:u.slice(c.length))}},{key:"applyValueChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this._formElement.value=this.applyMask(this._formElement.value,this.maskExpression,e,t),this._formElement!==this.document.activeElement&&this.clearIfNotMatchFn()}},{key:"hideInput",value:function(e,t){var i=this;return e.split("").map((function(e,r){return i.maskAvailablePatterns&&i.maskAvailablePatterns[t[r]]&&i.maskAvailablePatterns[t[r]].symbol?i.maskAvailablePatterns[t[r]].symbol:e})).join("")}},{key:"getActualValue",value:function(e){var t=this,i=e.split("").filter((function(e,i){return t._checkSymbolMask(e,t.maskExpression[i])||t.maskSpecialCharacters.includes(t.maskExpression[i])&&e===t.maskExpression[i]}));return i.join("")===e?i.join(""):e}},{key:"shiftTypedSymbols",value:function(e){var t=this,i="";return(e&&e.split("").map((function(r,n){if(t.maskSpecialCharacters.includes(e[n+1])&&e[n+1]!==t.maskExpression[n+1])return i=r,e[n+1];if(i.length){var s=i;return i="",s}return r}))||[]).join("")}},{key:"showMaskInInput",value:function(e){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}return this.showMaskTyped?e?this._checkForIp(e):this.maskExpression.replace(/\w/g,this.placeHolderCharacter):""}},{key:"clearIfNotMatchFn",value:function(){this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==this._formElement.value.replace(/_/g,"").length&&(this.formElementProperty=["value",""],this.applyMask(this._formElement.value,this.maskExpression))}},{key:"checkSpecialCharAmount",value:function(e){var t=this;return e.split("").filter((function(e){return t._findSpecialChar(e)})).length}},{key:"_checkForIp",value:function(e){if("#"===e)return"".concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter);for(var t=[],i=0;i<e.length;i++)e[i].match("\\d")&&t.push(e[i]);return t.length<=3?"".concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter):t.length>3&&t.length<=6?"".concat(this.placeHolderCharacter,".").concat(this.placeHolderCharacter):t.length>6&&t.length<=9?this.placeHolderCharacter:""}},{key:"formControlResult",value:function(e){Array.isArray(this.dropSpecialCharacters)?this.onChange(this._removeMask(this._removeSuffix(this._removePrefix(e)),this.dropSpecialCharacters)):this.onChange(this.dropSpecialCharacters?this._checkSymbols(e):this._removeSuffix(this._removePrefix(e)))}},{key:"_removeMask",value:function(e,t){return e?e.replace(this._regExpForRemove(t),""):e}},{key:"_removePrefix",value:function(e){return this.prefix&&e?e.replace(this.prefix,""):e}},{key:"_removeSuffix",value:function(e){return this.suffix&&e?e.replace(this.suffix,""):e}},{key:"_retrieveSeparatorValue",value:function(e){return this._removeMask(this._removeSuffix(this._removePrefix(e)),this.maskSpecialCharacters)}},{key:"_regExpForRemove",value:function(e){return new RegExp(e.map((function(e){return"\\"+e})).join("|"),"gi")}},{key:"_checkSymbols",value:function(e){if(""===e)return e;var t=this._retrieveSeparatorPrecision(this.maskExpression),i=this._retrieveSeparatorValue(e);return"."!==this.decimalMarker&&(i=i.replace(this.decimalMarker,".")),this.isNumberValue?t?e===this.decimalMarker?null:this._checkPrecision(this.maskExpression,i):Number(i):i}},{key:"_retrieveSeparatorPrecision",value:function(e){var t=e.match(new RegExp("^separator\\.([^d]*)"));return t?Number(t[1]):null}},{key:"_checkPrecision",value:function(e,t){return e.indexOf("2")>0?Number(t).toFixed(2):Number(t)}},{key:"formElementProperty",set:function(e){var t=_slicedToArray(e,2),i=t[0],r=t[1];this._renderer.setProperty(this._formElement,i,r)}}]),i}(h),p=function(){function e(t,i,r){_classCallCheck(this,e),this.document=t,this._maskService=i,this._config=r,this.maskExpression="",this.specialCharacters=[],this.patterns={},this.prefix="",this.suffix="",this.thousandSeparator=" ",this.decimalMarker=".",this.dropSpecialCharacters=null,this.hiddenInput=null,this.showMaskTyped=null,this.placeHolderCharacter=null,this.shownMaskExpression=null,this.showTemplate=null,this.clearIfNotMatch=null,this.validation=null,this.separatorLimit=null,this.allowNegativeNumbers=null,this._maskValue="",this._position=null,this.onChange=function(e){},this.onTouch=function(){}}return _createClass(e,[{key:"ngOnChanges",value:function(e){var t=e.maskExpression,i=e.specialCharacters,r=e.patterns,n=e.prefix,s=e.suffix,a=e.thousandSeparator,o=e.decimalMarker,l=e.dropSpecialCharacters,c=e.hiddenInput,u=e.showMaskTyped,h=e.placeHolderCharacter,f=e.shownMaskExpression,p=e.showTemplate,d=e.clearIfNotMatch,v=e.validation,g=e.separatorLimit,m=e.allowNegativeNumbers;if(t&&(this._maskValue=e.maskExpression.currentValue||""),i){if(!i.currentValue||!Array.isArray(i.currentValue))return;this._maskService.maskSpecialCharacters=e.specialCharacters.currentValue||[]}r&&r.currentValue&&(this._maskService.maskAvailablePatterns=r.currentValue),n&&(this._maskService.prefix=n.currentValue),s&&(this._maskService.suffix=s.currentValue),a&&(this._maskService.thousandSeparator=a.currentValue),o&&(this._maskService.decimalMarker=o.currentValue),l&&(this._maskService.dropSpecialCharacters=l.currentValue),c&&(this._maskService.hiddenInput=c.currentValue),u&&(this._maskService.showMaskTyped=u.currentValue),h&&(this._maskService.placeHolderCharacter=h.currentValue),f&&(this._maskService.shownMaskExpression=f.currentValue),p&&(this._maskService.showTemplate=p.currentValue),d&&(this._maskService.clearIfNotMatch=d.currentValue),v&&(this._maskService.validation=v.currentValue),g&&(this._maskService.separatorLimit=g.currentValue),m&&(this._maskService.maskSpecialCharacters=this._maskService.maskSpecialCharacters.filter((function(e){return"-"!==e}))),this._applyMask()}},{key:"validate",value:function(e){var t=this,i=e.value;if(!this._maskService.validation)return null;if(this._maskService.ipError)return this._createValidationError(i);if(this._maskValue.startsWith("separator"))return null;if(u.includes(this._maskValue))return null;if(this._maskService.clearIfNotMatch)return null;if(c.includes(this._maskValue))return this._validateTime(i);if(i&&i.toString().length>=1){var r=0,n=function(e){if(t._maskService.maskAvailablePatterns[e].optional&&!0===t._maskService.maskAvailablePatterns[e].optional){if(t._maskValue.indexOf(e)!==t._maskValue.lastIndexOf(e)?r+=t._maskValue.split("").filter((function(t){return t===e})).join("").length:-1!==t._maskValue.indexOf(e)&&r++,-1!==t._maskValue.indexOf(e)&&i.toString().length>=t._maskValue.indexOf(e))return{v:null};if(r===t._maskValue.length)return{v:null}}};for(var s in this._maskService.maskAvailablePatterns){var a=n(s);if("object"==typeof a)return a.v}if(1===this._maskValue.indexOf("{")&&i.toString().length===this._maskValue.length+Number(this._maskValue.split("{")[1].split("}")[0])-4)return null;if(1===this._maskValue.indexOf("*")||1===this._maskValue.indexOf("?"))return null;if(this._maskValue.indexOf("*")>1&&i.toString().length<this._maskValue.indexOf("*")||this._maskValue.indexOf("?")>1&&i.toString().length<this._maskValue.indexOf("?")||1===this._maskValue.indexOf("{"))return this._createValidationError(i);if(-1===this._maskValue.indexOf("*")||-1===this._maskValue.indexOf("?")){var o=this._maskService.dropSpecialCharacters?this._maskValue.length-this._maskService.checkSpecialCharAmount(this._maskValue)-r:this._maskValue.length-r;if(i.toString().length<o)return this._createValidationError(i)}}return null}},{key:"onInput",value:function(e){var t=e.target;if(this._inputValue=t.value,this._maskValue){var i=1===t.selectionStart?t.selectionStart+this._maskService.prefix.length:t.selectionStart,r=0,n=!1;if(this._maskService.applyValueChanges(i,(function(e,t){r=e,n=t})),this.document.activeElement===t){this._position=1===this._position&&1===this._inputValue.length?null:this._position;var s=this._position?this._inputValue.length+i+r:i+("Backspace"!==this._code||n?r:0);s>this._getActualInputLength()&&(s=this._getActualInputLength()),t.setSelectionRange(s,s),(this.maskExpression.includes("H")||this.maskExpression.includes("M"))&&0===r&&t.setSelectionRange(t.selectionStart+1,t.selectionStart+1),this._position=null}}else this.onChange(t.value)}},{key:"onBlur",value:function(){this._maskService.clearIfNotMatchFn(),this.onTouch()}},{key:"onFocus",value:function(e){var t=e.target;null!==t&&null!==t.selectionStart&&t.selectionStart===t.selectionEnd&&t.selectionStart>this._maskService.prefix.length&&38!==e.keyCode&&this._maskService.showMaskTyped&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),t.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===t.value?(t.focus(),t.setSelectionRange(0,0)):t.selectionStart>this._maskService.actualValue.length&&t.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));var i=t.value&&t.value!==this._maskService.prefix?t.value:this._maskService.prefix+this._maskService.maskIsShown;t.value!==i&&(t.value=i),(t.selectionStart||t.selectionEnd)<=this._maskService.prefix.length?t.selectionStart=this._maskService.prefix.length:t.selectionEnd>this._getActualInputLength()&&(t.selectionEnd=this._getActualInputLength())}},{key:"onKeyDown",value:function(e){this._code=e.code?e.code:e.key;var t=e.target;if(this._inputValue=t.value,38===e.keyCode&&e.preventDefault(),37===e.keyCode||8===e.keyCode||46===e.keyCode){if(8===e.keyCode&&0===t.value.length&&(t.selectionStart=t.selectionEnd),8===e.keyCode&&0!==t.selectionStart)if(this.specialCharacters=this.specialCharacters||this._config.specialCharacters,this.prefix.length>1&&t.selectionStart<=this.prefix.length)t.setSelectionRange(this.prefix.length,this.prefix.length);else{if(this._inputValue.length!==t.selectionStart&&1!==t.selectionStart)for(;this.specialCharacters.includes(this._inputValue[t.selectionStart-1].toString())&&(this.prefix.length>=1&&t.selectionStart>this.prefix.length||0===this.prefix.length);)t.setSelectionRange(t.selectionStart-1,t.selectionStart-1);this.suffixCheckOnPressDelete(e.keyCode,t)}this.suffixCheckOnPressDelete(e.keyCode,t),this._maskService.prefix.length&&t.selectionStart<=this._maskService.prefix.length&&t.selectionEnd<=this._maskService.prefix.length&&e.preventDefault();var i=t.selectionStart;8!==e.keyCode||t.readOnly||0!==i||t.selectionEnd!==t.value.length||0===t.value.length||(this._position=this._maskService.prefix?this._maskService.prefix.length:0,this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position))}this.suffix&&this.suffix.length>1&&this._inputValue.length-this.suffix.length<t.selectionStart?t.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length):(65===e.keyCode&&!0===e.ctrlKey||65===e.keyCode&&!0===e.metaKey)&&(t.setSelectionRange(0,this._getActualInputLength()),e.preventDefault()),this._maskService.selStart=t.selectionStart,this._maskService.selEnd=t.selectionEnd}},{key:"writeValue",value:function(e){return Object(n.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:void 0===e&&(e=""),"number"==typeof e&&(e=String(e),e="."!==this.decimalMarker?e.replace(".",this.decimalMarker):e,this._maskService.isNumberValue=!0),this._maskService.formElementProperty=e&&this._maskService.maskExpression||this._maskService.maskExpression&&(this._maskService.prefix||this._maskService.showMaskTyped)?["value",this._maskService.applyMask(e,this._maskService.maskExpression)]:["value",e],this._inputValue=e;case 1:case"end":return t.stop()}}),t,this)})))}},{key:"registerOnChange",value:function(e){this.onChange=e,this._maskService.onChange=this.onChange}},{key:"registerOnTouched",value:function(e){this.onTouch=e}},{key:"suffixCheckOnPressDelete",value:function(e,t){46===e&&this.suffix.length>0&&this._inputValue.length-this.suffix.length<=t.selectionStart&&t.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length),8===e&&(this.suffix.length>1&&this._inputValue.length-this.suffix.length<t.selectionStart&&t.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length),1===this.suffix.length&&this._inputValue.length===t.selectionStart&&t.setSelectionRange(t.selectionStart-1,t.selectionStart-1))}},{key:"setDisabledState",value:function(e){this._maskService.formElementProperty=["disabled",e]}},{key:"onModelChange",value:function(e){e||(this._maskService.actualValue="")}},{key:"_repeatPatternSymbols",value:function(e){var t=this;return e.match(/{[0-9]+}/)&&e.split("").reduce((function(i,r,n){if(t._start="{"===r?n:t._start,"}"!==r)return t._maskService._findSpecialChar(r)?i+r:i;t._end=n;var s=Number(e.slice(t._start+1,t._end));return i+new Array(s+1).join(e[t._start-1])}),"")||e}},{key:"_applyMask",value:function(){this._maskService.maskExpression=this._repeatPatternSymbols(this._maskValue||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue,this._maskService.maskExpression)]}},{key:"_validateTime",value:function(e){var t=this._maskValue.split("").filter((function(e){return":"!==e})).length;return null===e||0===e.length?null:0==+e[e.length-1]&&e.length<t||e.length<=t-2?this._createValidationError(e):null}},{key:"_getActualInputLength",value:function(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}},{key:"_createValidationError",value:function(e){return{mask:{requiredMask:this._maskValue,actualValue:e}}}}]),e}(),d=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[{provide:a,useValue:t},{provide:o,useValue:l},{provide:s,useFactory:v,deps:[o,a]},h]}}},{key:"forChild",value:function(t){return{ngModule:e}}}]),e}();function v(e,t){return Object.assign({},e,t instanceof Function?t():t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self},jQxp:function(e,t,i){"use strict";var r=i("8Y7J"),n=i("MKJQ"),s=i("sZkV"),a=i("EFqu");i.d(t,"a",(function(){return c}));var o=r.ob({encapsulation:0,styles:[[".modal-icons[_ngcontent-%COMP%]{--background:transparent;padding-top:var(--ion-safe-area-top);z-index:99999}.modal-icons[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem}ion-content[_ngcontent-%COMP%]{--background:#000;overflow:hidden}.close-button[_ngcontent-%COMP%]{position:relative;z-index:2}ion-slides#image-modal[_ngcontent-%COMP%]{height:100vh;position:fixed;top:0;z-index:1;width:100%}"]],data:{}});function l(e){return r.Mb(0,[(e()(),r.qb(0,0,null,null,12,"ion-content",[["forceOverscroll","false"],["fullscreen",""],["scrollX","false"],["scrollY","false"]],null,null,null,n.db,n.l)),r.pb(1,49152,null,0,s.v,[r.h,r.k,r.x],{forceOverscroll:[0,"forceOverscroll"],fullscreen:[1,"fullscreen"],scrollX:[2,"scrollX"],scrollY:[3,"scrollY"]},null),(e()(),r.qb(2,0,null,0,5,"ion-item",[["class","modal-icons ion-no-padding ion-text-center"],["lines","none"]],null,null,null,n.mb,n.u)),r.pb(3,49152,null,0,s.I,[r.h,r.k,r.x],{lines:[0,"lines"]},null),(e()(),r.qb(4,0,null,0,3,"ion-button",[["class","ion-no-margin close-button"],["color","light"],["fill","clear"],["slot","end"]],null,[[null,"click"]],(function(e,t,i){var r=!0;return"click"===t&&(r=!1!==e.component.close()&&r),r}),n.V,n.d)),r.pb(5,49152,null,0,s.l,[r.h,r.k,r.x],{color:[0,"color"],fill:[1,"fill"]},null),(e()(),r.qb(6,0,null,0,1,"ion-icon",[["name","close"]],null,null,null,n.ib,n.q)),r.pb(7,49152,null,0,s.D,[r.h,r.k,r.x],{name:[0,"name"]},null),(e()(),r.qb(8,0,null,0,4,"ion-slides",[["id","image-modal"]],null,null,null,n.yb,n.G)),r.pb(9,49152,null,0,s.pb,[r.h,r.k,r.x],{options:[0,"options"]},null),(e()(),r.qb(10,0,null,0,2,"ion-slide",[],null,null,null,n.xb,n.F)),r.pb(11,49152,null,0,s.ob,[r.h,r.k,r.x],null,null),(e()(),r.qb(12,0,null,0,0,"img",[],[[8,"alt",0],[8,"src",4]],null,null,null,null))],(function(e,t){var i=t.component;e(t,1,0,"false","","false","false"),e(t,3,0,"none"),e(t,5,0,"light","clear"),e(t,7,0,"close"),e(t,9,0,i.sliderOpts)}),(function(e,t){var i=t.component;e(t,12,0,r.ub(1,"",i.img,""),i.img)}))}var c=r.mb("app-image-view",a.a,(function(e){return r.Mb(0,[(e()(),r.qb(0,0,null,null,1,"app-image-view",[],null,null,null,l,o)),r.pb(1,49152,null,0,a.a,[s.Fb],null,null)],null,null)}),{img:"img"},{},[])},"jT/F":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i("lGQG"),n=i("iqUP"),s=i("XNiG"),a=i("8Y7J"),o=function(){var e=function(){function e(t){_classCallCheck(this,e),this.authService=t,this.basePath="/uploads",this.baseFolder="".concat(this.basePath,"/").concat(this.authService.getLogin()),this.completed$=new s.a}return _createClass(e,[{key:"pushFileToStorage",value:function(e){var t=this,i=n.storage().ref().child("".concat(this.baseFolder,"/image_").concat(Date.now())).put(e);i.on(n.storage.TaskEvent.STATE_CHANGED,(function(e){}),(function(e){console.log(e)}),(function(){i.snapshot.ref.getDownloadURL().then((function(e){t.completed$.next(e)}))}))}}]),e}();return e.ngInjectableDef=a.Qb({factory:function(){return new e(a.Rb(r.a))},token:e,providedIn:"root"}),e}()},jbVo:function(e,t,i){"use strict";i("/LYu"),i("68W0"),i("1jS7"),i("SZog"),i("mrSG"),i("EFqu"),i("/9Oo"),i("Ewk1"),i("6XD3"),i.d(t,"a",(function(){return r}));var r=function e(){_classCallCheck(this,e)}},ndxW:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("XNiG"),n=i("8Y7J"),s=function(){var e=function e(){_classCallCheck(this,e),this.stateChanged=new r.a};return e.ngInjectableDef=n.Qb({factory:function(){return new e},token:e,providedIn:"root"}),e}()},usHs:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function e(){_classCallCheck(this,e)}}}]);